<div class="container">
  <div class="header-container" fxLayout="column" fxLayoutAlign="center center">
    <h2 translate>adaptationAction.form2.title</h2>
  </div>
  <form [formGroup]="form">
    <mat-vertical-stepper #stepper linear formArrayName="formArray">
      <mat-step formGroupName="0" [stepControl]="formArray?.get([0])">
        <ng-template matStepLabel>
          <span translate>adaptationAction.form2.registerInfo</span>
          <mat-icon
            (click)="goToLink('https://drive.google.com/file/d/1m74UIubAhJdOlfRSSPNgv-j86rQY1rUk/view?usp=sharing')"
            [matTooltip]="'adaptationAction.form2.registerInfoTooltip' | translate"
            >info</mat-icon
          >
        </ng-template>

        <label translate>adaptationAction.form2.AAType</label>
        <mat-radio-group
          #reportingEntityTypeControl="matRadioGroup"
          formControlName="adaptationActionTypeCtrl"
          class="custom-radio-group"
        >
          <mat-radio-button [matTooltip]="typesTooltipTxt[0]" value="1">
            <label translate>Tipo A - Instrumentos de pol√≠ticas y planes </label>
          </mat-radio-button>
          <mat-radio-button [matTooltip]="typesTooltipTxt[1]" value="2">
            <label translate>Tipo B - Proyectos y programas</label>
          </mat-radio-button>
          <mat-radio-button [matTooltip]="typesTooltipTxt[2]" value="3">
            <label translate>Tipo C - Actividades</label>
          </mat-radio-button>
        </mat-radio-group>

        <mat-form-field class="field-ppcn">
          <mat-label translate>adaptationAction.form2.AAName</mat-label>
          <input type="text" matInput formControlName="adaptationActionNameCtrl" />
          <mat-error translate>errorLabel.fieldRequired</mat-error>
        </mat-form-field>

        <mat-form-field class="field-ppcn">
          <mat-label translate>adaptationAction.form2.AAObjective</mat-label>
          <input type="text" matInput formControlName="adaptationActionTargetCtrl" />
          <mat-error translate>errorLabel.fieldRequired</mat-error>
        </mat-form-field>

        <mat-form-field class="field-ppcn">
          <mat-label translate>adaptationAction.form2.AADescription</mat-label>
          <input type="text" matInput formControlName="adaptationActionDescriptionCtrl" />
          <mat-error translate>errorLabel.fieldRequired</mat-error>
        </mat-form-field>

        <mat-form-field class="field-ppcn">
          <mat-label translate>adaptationAction.form2.AAGoal</mat-label>
          <input type="text" matInput formControlName="adaptationActionGoalCtrl" />
          <mat-error translate>errorLabel.fieldRequired</mat-error>
        </mat-form-field>

        <mat-form-field class="field-ppcn" appearance="fill">
          <mat-label translate>adaptationAction.form2.AAODS</mat-label>
          <mat-select formControlName="adaptationActionODSCtrl" multiple>
            <mat-option *ngFor="let element of ods" [value]="element.code">
              <label translate>{{ element.code }} - {{ element.name }}</label>
            </mat-option>
          </mat-select>
        </mat-form-field>

        <div fxLayout="row" class="button-box" fxLayoutAlign="end center">
          <app-generic-button
            [disabled]="formArray?.get([0]).invalid"
            (click)="stepper.next()"
            name="general.next"
          ></app-generic-button>
        </div>
      </mat-step>

      <mat-step formGroupName="1" [stepControl]="formArray?.get([1])">
        <ng-template matStepLabel>
          <span translate>general.GeographicLocation</span>
        </ng-template>

        <label translate>adaptationAction.form2.appScale</label>
        <mat-radio-group
          (change)="changeLocationValidations($event.value)"
          #appScaleControl="matRadioGroup"
          formControlName="appScaleCtrl"
          class="custom-radio-group"
        >
          <mat-radio-button [matTooltip]="typesTooltipTxt[0]" [value]="1">
            <label translate>Nacional </label>
          </mat-radio-button>
          <mat-radio-button [matTooltip]="typesTooltipTxt[1]" [value]="2">
            <label translate>Regional</label>
          </mat-radio-button>
          <mat-radio-button [matTooltip]="typesTooltipTxt[2]" [value]="3">
            <label translate>Local</label>
          </mat-radio-button>
        </mat-radio-group>

        <mat-form-field
          *ngIf="appScaleControl.value == 2 || appScaleControl.value == 3"
          class="field-ppcn"
          appearance="fill"
        >
          <mat-label translate>adaptationAction.form2.AAProvince</mat-label>
          <mat-select (selectionChange)="selectProvince($event.value)" formControlName="adaptationActionProvinceCtrl">
            <mat-option *ngFor="let province of provinces" [value]="province.id">
              <label translate>{{ province.name }}</label>
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field
          *ngIf="appScaleControl.value == 2 || appScaleControl.value == 3"
          class="field-ppcn"
          appearance="fill"
        >
          <mat-label translate>adaptationAction.form2.AACanton</mat-label>
          <mat-select (selectionChange)="selectCanton($event.value)" formControlName="adaptationActionCantonCtrl">
            <mat-option *ngFor="let element of canton" [value]="element.id">
              <label translate>{{ element.name }}</label>
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field
          *ngIf="appScaleControl.value == 2 || appScaleControl.value == 3"
          class="field-ppcn"
          appearance="fill"
        >
          <mat-label translate>adaptationAction.form2.AADistrict</mat-label>
          <mat-select formControlName="adaptationActionDistritCtrl">
            <mat-option *ngFor="let district of districts" [value]="district.id">
              <label translate>{{ district.name }}</label>
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field class="field-ppcn">
          <mat-label translate>adaptationAction.form2.narrativeActionPlace</mat-label>
          <input type="text" matInput formControlName="adaptationActionDescriptionNarrativeCtrl" />
          <mat-error translate>errorLabel.fieldRequired</mat-error>
        </mat-form-field>

        <div fxLayout="row" fxLayoutAlign=" center">
          <mat-form-field class="field-ppcn">
            <mat-label translate>adaptationAction.form2.attachGeographicalLocation</mat-label>
            <input type="text" matInput formControlName="adaptationActionLocationCtrl" />
            <mat-error translate>errorLabel.fieldRequired</mat-error>
          </mat-form-field>
          <input formControlName="adaptationActionLocationOtherCtrl" type="file" />
        </div>

        <div fxLayout="row" class="button-box" fxLayoutAlign="end center">
          <app-generic-button-secondary (click)="stepper.previous()" name="general.back">
          </app-generic-button-secondary>
          <app-generic-button
            [disabled]="formArray?.get([1]).invalid"
            (click)="stepper.next()"
            name="general.next"
          ></app-generic-button>
        </div>
      </mat-step>

      <mat-step formGroupName="2" [stepControl]="formArray?.get([2])">
        <ng-template matStepLabel>
          <span translate>adaptationAction.form2.categorizationNationalIntruments</span>
          <mat-icon
            (click)="
              goToLink(
                'https://docs.google.com/spreadsheets/d/1fDSEUgkJgE8Xq1sLggu4ds4aS2EmxedW/edit?usp=sharing&ouid=110424914348129594837&rtpof=true&sd=true'
              )
            "
            [matTooltip]="'adaptationAction.form2.categorizationNationalIntrumentsTooltip' | translate"
            >info</mat-icon
          >
        </ng-template>

        <mat-form-field class="field-ppcn" appearance="fill">
          <mat-label translate>adaptationAction.form2.selectTopic</mat-label>
          <mat-select (selectionChange)="changeSubTopics($event.value)" formControlName="adaptationActionThemeCtrl">
            <mat-option *ngFor="let topic of topics" [value]="topic.code">
              <label translate>{{ topic.name }}</label>
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field class="field-ppcn" appearance="fill">
          <mat-label translate>adaptationAction.form2.selectSubtopic</mat-label>
          <mat-select formControlName="adaptationActionTypologyCtrl">
            <mat-option *ngFor="let subTopic of subTopicsToShow" [value]="subTopic.code">
              <label translate>{{ subTopic.name }}</label>
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field class="field-ppcn" appearance="fill">
          <mat-label translate>adaptationAction.form2.selectActionType </mat-label>
          <mat-select formControlName="adaptationActionTypeCtrl">
            <mat-option [value]="1">
              <label translate>Option1 </label>
            </mat-option>

            <mat-option [value]="2">
              <label translate>Option2 </label>
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field class="field-ppcn">
          <mat-label translate>adaptationAction.form2.relationNDC</mat-label>
          <input type="text" matInput formControlName="adaptationActionGoalRelationCtrl" />
          <mat-error translate>errorLabel.fieldRequired</mat-error>
        </mat-form-field>

        <mat-form-field class="field-ppcn">
          <mat-label translate>adaptationAction.form2.relationshipAxis</mat-label>
          <input type="text" matInput formControlName="adaptationActionEjeRelationCtrl" />
          <mat-error translate>errorLabel.fieldRequired</mat-error>
        </mat-form-field>

        <mat-form-field class="field-ppcn">
          <mat-label translate>adaptationAction.form2.relationshipGuideline</mat-label>
          <input type="text" matInput formControlName="adaptationActionLinealRelationCtrl" />
          <mat-error translate>errorLabel.fieldRequired</mat-error>
        </mat-form-field>

        <div fxLayout="row" class="button-box" fxLayoutAlign="end center">
          <app-generic-button-secondary (click)="stepper.previous()" name="general.back">
          </app-generic-button-secondary>
          <app-generic-button
            [disabled]="formArray?.get([2]).invalid"
            (click)="stepper.next()"
            name="general.next"
          ></app-generic-button>
        </div>
      </mat-step>

      <mat-step formGroupName="3" [stepControl]="formArray?.get([3])">
        <ng-template matStepLabel>
          <span translate>adaptationAction.form2.relationshipInstruments</span>
        </ng-template>

        <mat-form-field class="field-ppcn">
          <mat-label translate>adaptationAction.form2.namePlanningInstrument</mat-label>
          <input type="text" matInput formControlName="adaptationActionInstrumentCtrl" />
          <mat-error translate>errorLabel.fieldRequired</mat-error>
        </mat-form-field>

        <mat-form-field class="field-ppcn">
          <mat-label translate>adaptationAction.form2.adaptationIntegrated</mat-label>
          <input type="text" matInput formControlName="adaptationActionDescriptionInstrumentCtrl" />
          <mat-error translate>errorLabel.fieldRequired</mat-error>
        </mat-form-field>

        <div fxLayout="row" class="button-box" fxLayoutAlign="end center">
          <app-generic-button-secondary (click)="stepper.previous()" name="general.back">
          </app-generic-button-secondary>
          <app-generic-button
            [disabled]="formArray?.get([3]).invalid"
            (click)="stepper.next()"
            name="general.next"
          ></app-generic-button>
        </div>
      </mat-step>

      <mat-step formGroupName="4" [stepControl]="formArray?.get([4])">
        <ng-template matStepLabel>
          <span translate>adaptationAction.form2.climateRelatedHazard</span>
        </ng-template>

        <mat-form-field class="field-ppcn" appearance="fill">
          <mat-label translate>adaptationAction.form2.relatedClimateThreat</mat-label>
          <mat-select #climateValue formControlName="adaptationActionClimateThreatCtrl">
            <mat-option *ngFor="let climate of climateThreat" [value]="climate.id">
              <label translate>{{ climate.name }}</label>
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field *ngIf="climateValue.value === climateThreat.length" class="field-ppcn">
          <mat-label translate>adaptationAction.form2.relatedClimateThreatOther</mat-label>
          <input type="text" matInput formControlName="adaptationActionClimateThreatOtherCtrl" />
          <mat-error translate>errorLabel.fieldRequired</mat-error>
        </mat-form-field>

        <div fxLayout="row" fxLayoutAlign=" center">
          <mat-form-field class="field-ppcn">
            <mat-label translate>adaptationAction.form2.descriptionRelatedClimateThreat</mat-label>
            <input matInput formControlName="adaptationActionInfoSourceCtrl" />
            <mat-error translate>errorLabel.fieldRequired</mat-error>
          </mat-form-field>
          <input type="file" name="filename2" />
          <br />
        </div>

        <div fxLayout="row" class="button-box" fxLayoutAlign="end center">
          <app-generic-button-secondary (click)="stepper.previous()" name="general.back">
          </app-generic-button-secondary>
          <app-generic-button
            [disabled]="formArray?.get([4]).invalid"
            (click)="stepper.next()"
            name="general.next"
          ></app-generic-button>
        </div>
      </mat-step>

      <mat-step formGroupName="5" [stepControl]="formArray?.get([5])">
        <ng-template matStepLabel>
          <span translate>adaptationAction.form2.implementation</span>
        </ng-template>

        <mat-form-field class="field-ppcn">
          <mat-label translate>adaptationAction.form2.startImplementation</mat-label>
          <input
            matInput
            [placeholder]="'Choose a date' | translate"
            [matDatepicker]="adaptationActionStartDate"
            formControlName="adaptationActionStartDateCtrl"
          />

          <mat-datepicker-toggle matSuffix [for]="adaptationActionStartDate"></mat-datepicker-toggle>
          <mat-datepicker #adaptationActionStartDate startView="year"></mat-datepicker>

          <mat-error translate>errorLabel.fieldRequired</mat-error>
        </mat-form-field>

        <mat-form-field class="field-ppcn">
          <mat-label translate>adaptationAction.form2.endImplementation</mat-label>
          <input
            matInput
            [placeholder]="'Choose a date' | translate"
            [matDatepicker]="adaptationActionEndDate"
            formControlName="adaptationActionEndDateCtrl"
          />

          <mat-datepicker-toggle matSuffix [for]="adaptationActionEndDate"></mat-datepicker-toggle>
          <mat-datepicker #adaptationActionEndDate startView="year"></mat-datepicker>

          <mat-error translate>errorLabel.fieldRequired</mat-error>
        </mat-form-field>

        <mat-form-field class="field-ppcn">
          <mat-label translate>adaptationAction.form2.durationAction</mat-label>
          <input type="text" matInput formControlName="adaptationActionDurationTimeCtrl" />
          <mat-error translate>errorLabel.fieldRequired</mat-error>
        </mat-form-field>

        <mat-form-field class="field-ppcn">
          <mat-label translate>adaptationAction.form2.responsibleExecuting</mat-label>
          <input type="text" matInput formControlName="adaptationActionEntityCtrl" />
          <mat-error translate>errorLabel.fieldRequired</mat-error>
        </mat-form-field>

        <mat-form-field class="field-ppcn">
          <mat-label translate>adaptationAction.form2.otherEntitiesInvolved</mat-label>
          <input type="text" matInput formControlName="adaptationActionEntityOthersCtrl" />
          <mat-error translate>errorLabel.fieldRequired</mat-error>
        </mat-form-field>

        <mat-form-field class="field-ppcn">
          <mat-label translate>adaptationAction.form2.actionCode</mat-label>
          <input disabled type="text" matInput [value]="'AA' + reportingEntityTypeControl.value + '0001'" />
          <mat-error translate>errorLabel.fieldRequired</mat-error>
        </mat-form-field>

        <div fxLayout="row" class="button-box" fxLayoutAlign="end center">
          <app-generic-button-secondary (click)="stepper.previous()" name="general.back">
          </app-generic-button-secondary>
          <app-generic-button
            [disabled]="formArray?.get([5]).invalid"
            (click)="submitForm()"
            name="general.next"
          ></app-generic-button>
        </div>
      </mat-step>
    </mat-vertical-stepper>
  </form>
</div>
