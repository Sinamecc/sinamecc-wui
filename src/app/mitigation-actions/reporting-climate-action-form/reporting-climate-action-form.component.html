<div class="container">
  <div class="header-container" fxLayout="column" fxLayoutAlign="center center">
    <h2 translate>mitigationAction.monitoringReportingClimateActions</h2>
  </div>
  <mat-card-content>
    <form *ngIf="newFormData | async" [formGroup]="form" (ngSubmit)="submitForm()">
      <div fxLayout="column">
        <mat-vertical-stepper formArrayName="formArray" linear #stepper>
          <mat-step formGroupName="0" [stepControl]="formArray?.get([0])">
            <ng-template matStepLabel>
              <span>6.1 - </span><span translate>mitigationAction.monitoringProgressLog</span>
            </ng-template>

            <div>
              <label class="radio-grup-label" translate
                >6.1.1 - <span translate>mitigationAction.anyProgressMonitoringRecordedClimateActions</span></label
              >
              <mat-radio-group
                class="custom-radio-group"
                formControlName="anyProgressMonitoringRecordedClimateActionsCtrl"
              >
                <mat-radio-button [style.margin.px]="5" [value]="true">
                  <label translate>general.yes</label>
                </mat-radio-button>
                <mat-radio-button [style.margin.px]="5" [value]="false">
                  <label translate>No</label>
                </mat-radio-button>
              </mat-radio-group>
            </div>
            <br />

            <div class="box-button">
              <app-generic-button (click)="stepper.next()" name="general.next"></app-generic-button>
            </div>
          </mat-step>

          <mat-step
            *ngIf="form.value.formArray[0].anyProgressMonitoringRecordedClimateActionsCtrl"
            formGroupName="1"
            [stepControl]="formArray?.get([1])"
          >
            <ng-template matStepLabel>
              <span>6.2 - </span><span translate>mitigationAction.indicatorMonitoring</span>
            </ng-template>

            <div>
              <label class="radio-grup-label" translate
                >6.2.1 - <span translate>mitigationAction.indicatorSelection</span></label
              ><br />
              <mat-hint>Haga click en el indicador de interés para reportar su avance'</mat-hint>
              <mat-radio-group class="custom-radio-group" formControlName="indicatorSelectionCtrl">
                <mat-radio-button *ngFor="let item of indicator" [style.margin.px]="5" [value]="item.id">
                  <label translate>{{ item.name }}</label>
                </mat-radio-button>
              </mat-radio-group>
            </div>
            <br />

            <div fxLayout="row" fxLayoutAlign="start center">
              <mat-form-field [style.width.%]="100" class="ppcn-field">
                <mat-label translate>6.2.1.1 - <span translate>mitigationAction.reportingPeriod</span></mat-label>
                <input
                  matInput
                  [placeholder]="'Choose a date' | translate"
                  [matDatepicker]="reportingPeriodStartDateDatePicker"
                  formControlName="reportingPeriodStartCtrl"
                />

                <mat-datepicker-toggle matSuffix [for]="reportingPeriodStartDateDatePicker"></mat-datepicker-toggle>
                <mat-datepicker #reportingPeriodStartDateDatePicker startView="year"></mat-datepicker>

                <mat-error translate>errorLabel.fieldRequired</mat-error>
              </mat-form-field>

              <mat-form-field [style.width.%]="100" class="ppcn-field">
                <mat-label translate>general.until</mat-label>
                <input
                  matInput
                  [placeholder]="'Choose a date' | translate"
                  [matDatepicker]="reportingPeriodEndDateDatePicker"
                  formControlName="reportingPeriodEndCtrl"
                />

                <mat-datepicker-toggle matSuffix [for]="reportingPeriodEndDateDatePicker"></mat-datepicker-toggle>
                <mat-datepicker #reportingPeriodEndDateDatePicker startView="year"></mat-datepicker>

                <mat-error translate>errorLabel.fieldRequired</mat-error>
              </mat-form-field>
            </div>
            <br />

            <mat-form-field [style.width.%]="100" class="ppcn-field">
              <mat-label translate>6.2.1.2 - <span translate>mitigationAction.indicatorDataUpdateDate</span></mat-label>
              <input
                matInput
                [placeholder]="'Choose a date' | translate"
                [matDatepicker]="indicatordataUpdateDateDatePicker"
                formControlName="indicatorDataUpdateDateCtrl"
              />

              <mat-datepicker-toggle matSuffix [for]="indicatordataUpdateDateDatePicker"></mat-datepicker-toggle>
              <mat-datepicker #indicatordataUpdateDateDatePicker startView="year"></mat-datepicker>

              <mat-error translate>errorLabel.fieldRequired</mat-error>
            </mat-form-field>
            <br />

            <div>
              <label class="radio-grup-label" translate
                >6.2.1.3 - <span translate>mitigationAction.sourceType</span></label
              ><br />
              <mat-radio-group #informationToUpdate="matRadioGroup" class="custom-radio-group">
                <mat-radio-button [style.margin.px]="5" [value]="1">
                  <label translate>Línea de texto para el reporte</label>
                </mat-radio-button>
                <mat-radio-button [style.margin.px]="5" [value]="2">
                  <label translate>Carga de documento</label>
                </mat-radio-button>
                <mat-radio-button [style.margin.px]="5" [value]="3">
                  <label translate>Conexión con webservice: brindar detalles de la conexión </label>
                </mat-radio-button>
              </mat-radio-group>
            </div>
            <br />

            <div *ngIf="informationToUpdate.value === 1 || informationToUpdate.value === 3">
              <mat-form-field [style.margin-right]="'10px'" [style.width.%]="100" class="ppcn-field">
                <mat-label translate
                  >6.2.1.3 - <span translate>mitigationAction.sourceType</span>
                  {{ informationToUpdate.value === 3 ? '- Webservice' : '' }}
                </mat-label>
                <input type="text" matInput formControlName="informationToUpdateCtrl" required />
                <mat-error translate>errorLabel.fieldRequired</mat-error>
              </mat-form-field>
            </div>

            <div *ngIf="informationToUpdate.value === 2">
              <div fxLayout="row" fxLayoutAlign=" center">
                <mat-label translate>6.2.1.3 - <span translate>mitigationAction.informationToUpdate</span></mat-label>
                <input type="file" name="filename" />
                <br />
              </div>
            </div>

            <div class="box-button">
              <app-generic-button-secondary type="button" (click)="stepper.previous()" name="general.back">
              </app-generic-button-secondary>
              <app-generic-button (click)="stepper.next()" name="general.next"></app-generic-button>
            </div>
          </mat-step>

          <mat-step
            *ngIf="form.value.formArray[0].anyProgressMonitoringRecordedClimateActionsCtrl"
            formGroupName="2"
            [stepControl]="formArray?.get([2])"
          >
            <ng-template matStepLabel>
              <span>6.3 - </span><span translate>mitigationAction.generalProgressReportClimateAction</span>
            </ng-template>

            <mat-form-field [style.width.%]="100" class="ppcn-field">
              <mat-label translate>6.3.1 - <span translate>mitigationAction.reportingPeriod</span></mat-label>
              <input
                matInput
                [placeholder]="'Choose a date' | translate"
                [matDatepicker]="reportingPeriodDatePicker"
                formControlName="reportingPeriodCtrl"
              />

              <mat-datepicker-toggle matSuffix [for]="reportingPeriodDatePicker"></mat-datepicker-toggle>
              <mat-datepicker #reportingPeriodDatePicker startView="year"></mat-datepicker>

              <mat-error translate>errorLabel.fieldRequired</mat-error>
            </mat-form-field>

            <mat-form-field [style.margin-right]="'10px'" [style.width.%]="100" class="ppcn-field">
              <mat-label translate>6.3.2 - <span translate>mitigationAction.beenProgressActionPeriod</span></mat-label>
              <input type="text" matInput formControlName="beenProgressActionPeriodCtrl" required />
              <mat-error translate>errorLabel.fieldRequired</mat-error>
            </mat-form-field>

            <div class="box-button">
              <app-generic-button-secondary type="button" (click)="stepper.previous()" name="general.back">
              </app-generic-button-secondary>
              <app-generic-button (click)="stepper.next()" name="general.next"></app-generic-button>
            </div>
          </mat-step>

          <mat-step>
            <ng-template matStepLabel> <span translate> specificLabel.confirmInformation </span></ng-template>

            <div *ngIf="form.valid; else elseBlock" translate>specificLabel.everythingCorrect</div>

            <ng-template #elseBlock translate>Check the form for any errors marked in red</ng-template>
            <div class="align-right">
              <app-generic-button type="submit" [disabled]="wasSubmittedSuccessfully" name="general.done">
              </app-generic-button>
            </div>
          </mat-step>
        </mat-vertical-stepper>
      </div>
    </form>
  </mat-card-content>
</div>
