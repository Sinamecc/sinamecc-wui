<mat-dialog-content>
  <div class="report-error" [hidden]="!error || loading || !errorComponent.showErrors" translate>
    <span translate>errorLabel.errorSubmittingForm</span>
    <br />
    <app-error-reporting #errorComponent></app-error-reporting>
  </div>
  <form [formGroup]="form" (ngSubmit)="submitForm()">
    <div class="flex flex-col">
      <mat-vertical-stepper formArrayName="formArray" linear #stepper>
        <mat-step formGroupName="0" [stepControl]="formArray?.get([0])">
          <ng-template matStepLabel>
            <span>6.2 - </span><span translate>mitigationAction.indicatorMonitoring</span>
          </ng-template>

          <div class="flex flex-row justify-start items-center">
            <mat-form-field [style.width.%]="100" class="ppcn-field">
              <mat-label translate>6.2.1.1 - <span translate>mitigationAction.reportingPeriod</span></mat-label>
              <input
                matInput
                [placeholder]="'Choose a date' | translate"
                [matDatepicker]="reportingPeriodStartDateDatePicker"
                formControlName="reportingPeriodStartCtrl"
              />

              <mat-datepicker-toggle matSuffix [for]="reportingPeriodStartDateDatePicker"></mat-datepicker-toggle>
              <mat-datepicker #reportingPeriodStartDateDatePicker startView="year"></mat-datepicker>

              <mat-error translate>errorLabel.fieldRequired</mat-error>
            </mat-form-field>

            <mat-form-field [style.width.%]="100" class="ppcn-field">
              <mat-label translate>general.until</mat-label>
              <input
                matInput
                [placeholder]="'Choose a date' | translate"
                [matDatepicker]="reportingPeriodEndDateDatePicker"
                formControlName="reportingPeriodEndCtrl"
              />

              <mat-datepicker-toggle matSuffix [for]="reportingPeriodEndDateDatePicker"></mat-datepicker-toggle>
              <mat-datepicker #reportingPeriodEndDateDatePicker startView="year"></mat-datepicker>

              <mat-error translate>errorLabel.fieldRequired</mat-error>
            </mat-form-field>
          </div>
          <br />

          <mat-form-field [style.width.%]="100" class="ppcn-field">
            <mat-label translate>6.2.1.2 - <span translate>mitigationAction.indicatorDataUpdateDate</span></mat-label>
            <input
              matInput
              [placeholder]="'Choose a date' | translate"
              [matDatepicker]="indicatordataUpdateDateDatePicker"
              formControlName="indicatorDataUpdateDateCtrl"
            />

            <mat-datepicker-toggle matSuffix [for]="indicatordataUpdateDateDatePicker"></mat-datepicker-toggle>
            <mat-datepicker #indicatordataUpdateDateDatePicker startView="year"></mat-datepicker>

            <mat-error translate>errorLabel.fieldRequired</mat-error>
          </mat-form-field>
          <br />

          <div>
            <label class="radio-grup-label" translate
              >6.2.1.3 - <span translate>mitigationAction.dataEntryMonitoring</span></label
            ><br />
            <mat-radio-group
              formControlName="reportTypeCtrl"
              #informationToUpdate="matRadioGroup"
              class="custom-radio-group"
            >
              <mat-radio-button [style.margin.px]="5" [value]="1">
                <label translate>Dato de monitoreo</label>
              </mat-radio-button>
              <mat-radio-button [style.margin.px]="5" [value]="2">
                <label translate>Carga de documento</label>
              </mat-radio-button>
              <mat-radio-button [style.margin.px]="5" [value]="3">
                <label translate>Conexión con webservice: brindar detalles de la conexión </label>
              </mat-radio-button>
            </mat-radio-group>
          </div>
          <br />

          <div *ngIf="informationToUpdate.value === 1 || informationToUpdate.value === 3">
            <mat-form-field [style.margin-right]="'10px'" [style.width.%]="100" class="ppcn-field">
              <mat-label translate
                >6.2.1.3 - <span translate>mitigationAction.dataEntryMonitoring</span>
                {{ informationToUpdate.value === 3 ? '- Webservice' : '' }}
              </mat-label>
              <input type="text" matInput formControlName="informationToUpdateCtrl" required />
              <mat-error translate>errorLabel.fieldRequired</mat-error>
            </mat-form-field>
          </div>

          <div *ngIf="informationToUpdate.value === 2">
            <div class="flex flex-row justify-center">
              <mat-label translate>6.2.1.3 - <span translate>mitigationAction.informationToUpdate</span></mat-label>
              <input type="file" name="informationToUpdateFile" (change)="uploadFile($event)" />
              <br />
            </div>
          </div>

          <div class="box-button">
            <button type="button" matRipple (click)="stepper.next()" class="primary-button">
              <span translate>general.next</span>
            </button>
          </div>
        </mat-step>

        <mat-step formGroupName="1" [stepControl]="formArray?.get([1])">
          <ng-template matStepLabel>
            <span>6.3 - </span><span translate>mitigationAction.generalProgressReportClimateAction</span>
          </ng-template>

          <mat-form-field [style.width.%]="100" class="ppcn-field">
            <mat-label translate>6.3.1 - <span translate>mitigationAction.reportingPeriod</span></mat-label>
            <input
              matInput
              [placeholder]="'Choose a date' | translate"
              [matDatepicker]="reportingPeriodDatePicker"
              formControlName="reportingPeriodCtrl"
            />

            <mat-datepicker-toggle matSuffix [for]="reportingPeriodDatePicker"></mat-datepicker-toggle>
            <mat-datepicker #reportingPeriodDatePicker startView="year"></mat-datepicker>

            <mat-error translate>errorLabel.fieldRequired</mat-error>
          </mat-form-field>

          <mat-form-field [style.width.%]="100" class="ppcn-field">
            <mat-label translate>6.3.1 - <span translate>general.until</span></mat-label>
            <input
              matInput
              [placeholder]="'Choose a date' | translate"
              [matDatepicker]="reportingPeriodUntilDatePicker"
              formControlName="reportingPeriodUntilCtrl"
            />

            <mat-datepicker-toggle matSuffix [for]="reportingPeriodUntilDatePicker"></mat-datepicker-toggle>
            <mat-datepicker #reportingPeriodUntilDatePicker startView="year"></mat-datepicker>

            <mat-error translate>errorLabel.fieldRequired</mat-error>
          </mat-form-field>

          <mat-form-field [style.margin-right]="'10px'" [style.width.%]="100" class="ppcn-field">
            <mat-label translate>6.3.2 - <span translate>mitigationAction.beenProgressActionPeriod</span></mat-label>
            <input type="text" matInput formControlName="beenProgressActionPeriodCtrl" required />
            <mat-error translate>errorLabel.fieldRequired</mat-error>
          </mat-form-field>

          <div class="box-button">
            <app-generic-button-secondary type="button" (click)="stepper.previous()" name="general.back">
            </app-generic-button-secondary>
            <button type="button" matRipple (click)="stepper.next()" class="primary-button">
              <span translate>general.next</span>
            </button>
          </div>
        </mat-step>

        <mat-step>
          <ng-template matStepLabel> <span translate> specificLabel.confirmInformation </span></ng-template>

          <div *ngIf="form.valid; else elseBlock" translate>specificLabel.everythingCorrect</div>
          <ng-template #elseBlock translate>Check the form for any errors marked in red</ng-template>
          <div class="align-right">
            <button type="submit" matRipple class="primary-button">
              <span translate>general.add</span>
            </button>
          </div>
        </mat-step>
      </mat-vertical-stepper>
    </div>
  </form>
</mat-dialog-content>
