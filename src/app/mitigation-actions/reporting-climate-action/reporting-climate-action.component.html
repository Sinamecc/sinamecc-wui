<div class="container-custom">
  <div class="header-container flex flex-col justify-center items-center">
    <h2 translate>mitigationAction.monitoringReportingClimateActions</h2>
  </div>
  <h1>{{ mitigationAction?.code }}</h1>
  <mat-card-content>
    <form *ngIf="newFormData | async" [formGroup]="form">
      <div class="flex flex-col">
        <mat-vertical-stepper formArrayName="formArray" linear #stepper>
          <mat-step formGroupName="0" [stepControl]="formArray?.get([0])">
            <ng-template matStepLabel>
              <span>6.1 - </span><span translate>mitigationAction.monitoringProgressLog</span>
            </ng-template>

            <div>
              <label class="radio-grup-label" translate
                >6.1.1 - <span translate>mitigationAction.anyProgressMonitoringRecordedClimateActions</span></label
              >
              <mat-radio-group
                class="custom-radio-group"
                formControlName="anyProgressMonitoringRecordedClimateActionsCtrl"
              >
                <mat-radio-button [style.margin.px]="5" [value]="true">
                  <label translate>general.yes</label>
                </mat-radio-button>
                <mat-radio-button [style.margin.px]="5" [value]="false">
                  <label translate>No</label>
                </mat-radio-button>
              </mat-radio-group>
            </div>
            <br />

            <div class="box-button">
              <button type="button" matRipple (click)="stepper.next()" class="primary-button">
                <span translate>general.next</span>
              </button>
            </div>
          </mat-step>

          <mat-step
            *ngIf="form.value.formArray[0].anyProgressMonitoringRecordedClimateActionsCtrl"
            formGroupName="1"
            [stepControl]="formArray?.get([1])"
          >
            <ng-template matStepLabel>
              <span>6.2 - </span><span translate>mitigationAction.indicatorMonitoring</span>
            </ng-template>

            <div>
              <label class="radio-grup-label" translate
                >6.2.1 - <span translate>mitigationAction.indicatorSelection</span></label
              ><br />
              <mat-hint>Haga click en el indicador de inter√©s para reportar su avance'</mat-hint>
              <div>
                <mat-accordion>
                  <mat-expansion-panel
                    *ngFor="let item of mitigationAction?.monitoring_information?.indicator"
                    [style.margin.px]="5"
                    class="flex flex-col gap-2"
                  >
                    <mat-expansion-panel-header>
                      <mat-panel-title> {{ item.id }} - {{ item.name }} </mat-panel-title>
                    </mat-expansion-panel-header>
                    <div class="flex flex-col gap-2">
                      <div
                        *ngFor="let report of mitigationAction?.monitoring_reporting_indicator?.monitoring_indicator"
                        class="flex flex-row justify-between items-center"
                      >
                        <span>{{ report.id }} - {{ report.indicator }}</span>
                        <button type="button" class="primary-button" (click)="openDialog(item.id, report.id)">
                          <span translate>general.edit</span>
                        </button>
                      </div>
                      <div class="flex flex-row justify-end">
                        <button type="button" class="primary-button" (click)="openDialog(item.id)">
                          <span translate>general.add</span>
                        </button>
                      </div>
                    </div>
                  </mat-expansion-panel>
                </mat-accordion>
              </div>
            </div>
            <br />

            <div class="box-button">
              <app-generic-button-secondary type="button" (click)="stepper.previous()" name="general.back">
              </app-generic-button-secondary>
              <button type="button" matRipple (click)="stepper.next()" class="primary-button">
                <span translate>general.next</span>
              </button>
            </div>
          </mat-step>

          <mat-step>
            <ng-template matStepLabel> <span translate> specificLabel.confirmInformation </span></ng-template>

            <div *ngIf="form.valid; else elseBlock" translate>specificLabel.everythingCorrect</div>

            <ng-template #elseBlock translate>Check the form for any errors marked in red</ng-template>
            <div class="align-right">
              <button [disabled]="wasSubmittedSuccessfully" type="submit" matRipple class="primary-button">
                <span translate>general.dondeReview</span>
              </button>
            </div>
          </mat-step>
        </mat-vertical-stepper>
      </div>
    </form>
  </mat-card-content>
</div>
