<div class="container">
  <mat-card>
    <!--<h1>
      <mat-card-title translate>APP_NAME</mat-card-title>
      <app-loader [isLoading]="isLoading" size="1.5"></app-loader>
    </h1>-->
    <h3>
      <mat-card-title translate class="section-heading">reportData.createReport</mat-card-title>
      <mat-divider class="divider-custom"></mat-divider>
      <mat-divider class="divider-custom"></mat-divider>
    </h3>
    <mat-card-content>
      <form (ngSubmit)="submitForm()" [formGroup]="reportForm">
        <div fxLayout="column">
          <div class="report-error" [hidden]="!error || isLoading" translate>
            <span translate>errorLabel.errorSubmittingForm</span>
          </div>
          <mat-vertical-stepper formArrayName="formArray" linear #stepper>
            <mat-step formGroupName="0" [stepControl]="formArray?.get([0])">
              <ng-template matStepLabel>
                <span translate>reportData.methodologicalDetailsInformationRecorded </span>
              </ng-template>
              <br />
              <div fxLayout="column">
                <mat-icon [matTooltip]="'general.file' | translate">folder </mat-icon>
                <mat-form-field>
                  <input type="text" matInput formControlName="name" [placeholder]="'info.name' | translate" />
                  <!--
                  <mat-error *ngIf="reportForm.controls.name.valid || reportForm.controls.name.untouched">
                    <span translate>errorLabel.nameRequired</span>
                  </mat-error>
                -->
                </mat-form-field>
                <br />

                <mat-form-field class="field-ppcn">
                  <mat-label translate>reportData.dataReportsAnalysis</mat-label>
                  <input matInput formControlName="dataReportsAnalysisCtrl" />
                  <mat-error translate>errorLabel.fieldRequired</mat-error>
                </mat-form-field>

                <div fxLayout="row" fxLayoutAlign="start center">
                  <mat-form-field class="field-ppcn">
                    <mat-label translate>reportData.informationSources</mat-label>
                    <input matInput formControlName="informationSourcesCtrl" />
                    <mat-error translate>errorLabel.fieldRequired</mat-error>
                  </mat-form-field>
                  <mat-form-field class="field-ppcn">
                    <p translate class="text-upload"><span translate>reportData.uploadFile</span></p>
                    :
                    <app-input-file
                      id="file-input"
                      #FileInput
                      class="mat-raised-button mat-primary"
                      formControlName="file"
                      (change)="(FileInput)"
                      [valuePlaceholder]="'reportData.selectFile' | translate"
                      required
                    >
                      <mat-icon>vertical_align_top</mat-icon>
                      reportData.selectFile
                    </app-input-file>

                    <!--
                  <mat-error *ngIf="reportForm.get('file').hasError('required')" translate>
                    reportData.selectFile
                  </mat-error>
                  <mat-error *ngIf="reportForm.get('file').hasError('maxContentSize')">
                    <span translate
                      >The total size must not exceed
                      {{ reportForm.get('file')?.getError('maxContentSize').maxSize | byteFormat }} ({{
                        reportForm.get('file')?.getError('maxContentSize').actualSize | byteFormat
                      }}).</span
                    >
                  </mat-error>
-->
                  </mat-form-field>
                  <br />
                </div>

                <mat-form-field class="field-ppcn">
                  <mat-label translate>reportData.thematicCategorization</mat-label>
                  <input matInput formControlName="thematicCategorizationCtrl" />
                  <mat-error translate>errorLabel.fieldRequired</mat-error>
                </mat-form-field>

                <span translate>mitigationAction.datatype</span>
                <mat-radio-group
                  *ngIf="catalogs"
                  #dataType="matRadioGroup"
                  formControlName="dataTypeCtrl"
                  class="custom-radio-group"
                >
                  <mat-radio-button
                    *ngFor="let element of catalogs.thematic_categorization_type"
                    [style.margin.px]="5"
                    [value]="element.id"
                  >
                    <label translate>{{ element.name }}</label>
                  </mat-radio-button>
                </mat-radio-group>
                <br />

                <mat-form-field *ngIf="catalogs" class="field-ppcn" appearance="fill">
                  <mat-label translate>mitigationAction.SINAMECCClassifiers</mat-label>
                  <mat-select formControlName="sinameccClassifiersCtrl">
                    <mat-option *ngFor="let element of catalogs.classifier" [value]="element.id">
                      {{ element.name }}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>

              <div fxLayout="row" fxLayoutAlign="end center">
                <div>
                  <app-generic-button (click)="stepper.next()" name="general.next"></app-generic-button>
                </div>
              </div>
            </mat-step>

            <mat-step formGroupName="1" [stepControl]="formArray?.get([1])">
              <ng-template matStepLabel>
                <span translate>reportData.dataReport </span>
              </ng-template>

              <!-- Witing for BE Catalog -->
              <span translate>reportData.whatInformationReported</span>
              <mat-radio-group
                #whatInformationReported="matRadioGroup"
                formControlName="whatInformationReportedCtrl"
                class="custom-radio-group"
              >
                <mat-radio-button [style.margin.px]="5" [value]="'statistics_or_variable'">
                  <label translate>Una variable o estad√≠stica </label>
                </mat-radio-button>
                <mat-radio-button [style.margin.px]="5" [value]="'indicator'">
                  <label translate>Indicador</label>
                </mat-radio-button>
                <mat-radio-button [style.margin.px]="5" [value]="'data_base'">
                  <label translate>Base de datos</label>
                </mat-radio-button>
              </mat-radio-group>
              <br />
              <div *ngIf="whatInformationReported.value == 'indicator'">
                <span translate>reportData.isBaseline</span>
                <mat-radio-group
                  #isBaseline="matRadioGroup"
                  formControlName="isBaselineCtrl"
                  class="custom-radio-group"
                >
                  <mat-radio-button [style.margin.px]="5" [value]="true">
                    <label translate>general.yes </label>
                  </mat-radio-button>
                  <mat-radio-button [style.margin.px]="5" [value]="false">
                    <label translate>No</label>
                  </mat-radio-button>
                </mat-radio-group>
              </div>
              <br />
              <span translate>reportData.qualityPreItems</span>
              <mat-radio-group
                #qualityPreItems="matRadioGroup"
                formControlName="qualityPreItemsCtrl"
                class="custom-radio-group"
              >
                <mat-radio-button [style.margin.px]="5" [value]="true">
                  <label translate>general.yes </label>
                </mat-radio-button>
                <mat-radio-button [style.margin.px]="5" [value]="false">
                  <label translate>No</label>
                </mat-radio-button>
              </mat-radio-group>

              <mat-form-field *ngIf="qualityPreItems.value" class="field-ppcn">
                <mat-label translate>reportData.qualityPreItems</mat-label>
                <input matInput formControlName="qualityPreItemsValueCtrl" />
                <mat-error translate>errorLabel.fieldRequired</mat-error>
              </mat-form-field>

              <span translate>reportData.agreementTransferSINAMECC</span>
              <mat-radio-group
                #agreementTransferSINAMECC="matRadioGroup"
                formControlName="agreementTransferSINAMECCCtrl"
                class="custom-radio-group"
              >
                <mat-radio-button [style.margin.px]="5" [value]="true">
                  <label translate>general.yes </label>
                </mat-radio-button>
                <mat-radio-button [style.margin.px]="5" [value]="false">
                  <label translate>No</label>
                </mat-radio-button>
              </mat-radio-group>

              <mat-form-field *ngIf="agreementTransferSINAMECC.value" class="field-ppcn">
                <mat-label translate>reportData.agreementTransferSINAMECC</mat-label>
                <input matInput formControlName="agreementTransferSINAMECCValueCtrl" />
                <mat-error translate>errorLabel.fieldRequired</mat-error>
              </mat-form-field>

              <br />

              <div fxLayout="row" fxLayoutAlign="end center">
                <div>
                  <app-generic-button-secondary
                    type="button"
                    (click)="stepper.previous()"
                    name="general.back"
                  ></app-generic-button-secondary>
                </div>
                <div>
                  <app-generic-button (click)="stepper.next()" name="general.next"></app-generic-button>
                </div>
              </div>
            </mat-step>

            <mat-step formGroupName="2" [stepControl]="formArray?.get([2])">
              <ng-template matStepLabel>
                <span translate>info.contactInfo </span>
              </ng-template>

              <mat-form-field class="field-ppcn">
                <mat-label translate>info.name</mat-label>
                <input matInput formControlName="nameCtrl" />
                <mat-error translate>errorLabel.fieldRequired</mat-error>
              </mat-form-field>

              <mat-form-field class="field-ppcn">
                <mat-label translate>general.positionPerson</mat-label>
                <input matInput formControlName="positionCtrl" />
                <mat-error translate>errorLabel.fieldRequired</mat-error>
              </mat-form-field>

              <mat-form-field class="field-ppcn">
                <mat-label translate>info.emailAddress</mat-label>
                <input type="email" matInput formControlName="emailCtrl" />
                <mat-error translate>errorLabel.fieldRequired</mat-error>
              </mat-form-field>

              <mat-form-field class="field-ppcn">
                <mat-label translate>info.phone</mat-label>
                <input type="number" matInput formControlName="phoneCtrl" />
                <mat-error translate>errorLabel.fieldRequired</mat-error>
              </mat-form-field>

              <mat-form-field class="field-ppcn">
                <mat-label translate>reportData.additionalAnnotations</mat-label>
                <input matInput formControlName="logsCtrl" />
                <mat-error translate>errorLabel.fieldRequired</mat-error>
              </mat-form-field>

              <div fxLayout="row" fxLayoutAlign="end center">
                <div>
                  <app-generic-button-secondary
                    type="button"
                    (click)="stepper.previous()"
                    name="general.back"
                  ></app-generic-button-secondary>
                </div>
                <div>
                  <app-generic-button
                    type="submit"
                    [disabled]="reportForm.invalid || isLoading"
                    routerLink="/report/new"
                    name="reportData.submitReport"
                  >
                  </app-generic-button>
                  <app-loader class="inline-loader" [isLoading]="isLoading"></app-loader>
                </div>
              </div>
            </mat-step>
          </mat-vertical-stepper>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
